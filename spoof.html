<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Arc Android: Video Fullscreen (No Rotation) ‚ûú File Picker</title>
<style>
  body{
    margin:0; height:100vh; display:flex; align-items:center; justify-content:center;
    background:#071028; color:#e6eef6; font-family:system-ui,Segoe UI,Roboto,Arial;
  }
  .card{
    width:420px; max-width:92%; background:#071a2a; padding:24px; border-radius:12px;
    box-shadow:0 8px 30px rgba(0,0,0,.6);
  }
  h1{margin:0 0 8px;font-size:18px;text-align:center}
  p{margin:0 0 12px;color:#9fb7c7;text-align:center}
  button{
    display:block; width:100%; padding:12px 14px; border:0; border-radius:10px;
    font-weight:700; cursor:pointer; background:linear-gradient(90deg,#06b6d4,#3b82f6); color:#042630;
    margin-bottom:10px;
  }
  pre{background:#041621;color:#cfeff6;padding:10px;border-radius:8px;max-height:200px;overflow:auto}
  input[type=file]{display:none}
  video{
    width:1px; height:1px; position:absolute; left:-9999px; top:-9999px;
  }
</style>
</head>
<body>
  <div class="card" role="main" aria-live="polite">
    <h1>Arc Android ‚Äî Fullscreen Video (No Rotation)</h1>
    <p>Tap tombol: video masuk fullscreen dalam mode portrait (tanpa rotasi), lalu 1 detik kemudian buka file picker.</p>

    <button id="goBtn">Masuk Fullscreen (Video) Sekarang</button>
    <button id="fallbackPickerBtn" style="display:none;">Buka File Picker (Fallback)</button>

    <pre id="log">Status: ready</pre>

    <video id="fsVideo" playsinline muted preload="metadata">
      <source src="https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4" type="video/mp4">
    </video>

    <input id="fileInput" type="file" accept="image/*,text/plain">
  </div>

<script>
const logEl = document.getElementById('log');
const goBtn = document.getElementById('goBtn');
const fallbackBtn = document.getElementById('fallbackPickerBtn');
const fileInput = document.getElementById('fileInput');
const fsVideo = document.getElementById('fsVideo');

const log = (m) => logEl.textContent = (typeof m === 'string') ? m : JSON.stringify(m, null, 2);

// Coba kunci orientasi (portrait)
async function lockOrientation() {
  try {
    if (screen.orientation && screen.orientation.lock) {
      await screen.orientation.lock('portrait');
      log('üîí Orientasi layar dikunci ke portrait.');
    } else {
      log('‚ö†Ô∏è API orientasi tidak tersedia.');
    }
  } catch (err) {
    log('‚ö†Ô∏è Gagal mengunci orientasi: ' + (err.message || err));
  }
}

// Klik tombol ‚Üí lock orientation ‚Üí fullscreen video
goBtn.addEventListener('click', async () => {
  goBtn.style.display = 'none';
  log('üöÄ Mengunci orientasi & meminta video fullscreen...');
  await lockOrientation();

  try {
    try { await fsVideo.play(); } catch(_) {}

    if (fsVideo.requestFullscreen) {
      await fsVideo.requestFullscreen({ navigationUI: "hide" });
    } else if (fsVideo.webkitRequestFullscreen) {
      fsVideo.webkitRequestFullscreen();
    } else if (fsVideo.webkitEnterFullscreen) {
      fsVideo.webkitEnterFullscreen();
    } else {
      throw new Error('Fullscreen API untuk <video> tidak tersedia.');
    }
    log('‚úÖ Fullscreen video diminta. Menunggu konfirmasi...');
  } catch (e) {
    log('‚ùå Gagal fullscreen video: ' + (e.message || e));
    fallbackBtn.style.display = 'block';
  }
});

// Ketika fullscreen aktif, buka file picker setelah 1 detik
function onFsChange() {
  const inFs = document.fullscreenElement || document.webkitFullscreenElement || document.msFullscreenElement;
  if (inFs) {
    log('üü¢ Fullscreen aktif. Menunggu 1 detik sebelum buka file picker...');
    setTimeout(async () => {
      try {
        if (typeof fileInput.showPicker === 'function') {
          log('üìÇ Membuka file picker dengan showPicker()...');
          await fileInput.showPicker();
        } else {
          log('üìÇ showPicker() tidak ada, fallback ke click()...');
          fileInput.click();
        }
      } catch (err) {
        log('‚ö†Ô∏è Picker gagal: ' + (err.message || err));
        fallbackBtn.style.display = 'block';
      }
    }, 1000);
  } else {
    log('‚Ü©Ô∏è Keluar dari fullscreen.');
  }
}
document.addEventListener('fullscreenchange', onFsChange);
document.addEventListener('webkitfullscreenchange', onFsChange);

// Tombol fallback manual
fallbackBtn.addEventListener('click', () => {
  try {
    if (typeof fileInput.showPicker === 'function') fileInput.showPicker();
    else fileInput.click();
  } catch (e) {
    log('‚ùå Gagal membuka picker: ' + (e.message || e));
  }
});

// Log hasil file
fileInput.addEventListener('change', (e) => {
  const f = e.target.files && e.target.files[0];
  if (!f) return log('‚ùå Tidak ada file dipilih.');
  log(`‚úÖ File dipilih:\nNama: ${f.name}\nUkuran: ${f.size} bytes`);
});
</script>
</body>
</html>
