<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Arc Android: Video Fullscreen ‚ûú File Picker</title>
<style>
  body{
    margin:0; height:100vh; display:flex; align-items:center; justify-content:center;
    background:#071028; color:#e6eef6; font-family:system-ui,Segoe UI,Roboto,Arial;
  }
  .card{
    width:420px; max-width:92%; background:#071a2a; padding:24px; border-radius:12px;
    box-shadow:0 8px 30px rgba(0,0,0,.6);
  }
  h1{margin:0 0 8px;font-size:18px;text-align:center}
  p{margin:0 0 12px;color:#9fb7c7;text-align:center}
  button{
    display:block; width:100%; padding:12px 14px; border:0; border-radius:10px;
    font-weight:700; cursor:pointer; background:linear-gradient(90deg,#06b6d4,#3b82f6); color:#042630;
    margin-bottom:10px;
  }
  pre{background:#041621;color:#cfeff6;padding:10px;border-radius:8px;max-height:200px;overflow:auto}
  input[type=file]{display:none}
  /* Video mini (dipakai hanya sebagai target fullscreen) */
  video{
    width:1px; height:1px; position:absolute; left:-9999px; top:-9999px; /* sembunyikan dari layout */
  }
</style>
</head>
<body>
  <div class="card" role="main" aria-live="polite">
    <h1>Arc Android ‚Äî ‚ÄúJalan Lain‚Äù</h1>
    <p>Tap tombol: kita fullscreen-kan <code>&lt;video&gt;</code> (lebih kompatibel), lalu 1 detik kemudian buka file picker.</p>

    <button id="goBtn">Masuk Fullscreen (Video) Sekarang</button>
    <button id="fallbackPickerBtn" style="display:none;">Buka File Picker (Fallback)</button>

    <pre id="log">Status: ready</pre>

    <!-- Target fullscreen yang paling ‚Äúditerima‚Äù di Android: video -->
    <video id="fsVideo" playsinline muted preload="metadata">
      <source src="https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4" type="video/mp4">
    </video>

    <!-- File input klasik (paling kompatibel di Arc Android) -->
    <input id="fileInput" type="file" accept="image/*,text/plain">
  </div>

<script>
const logEl = document.getElementById('log');
const goBtn = document.getElementById('goBtn');
const fallbackBtn = document.getElementById('fallbackPickerBtn');
const fileInput = document.getElementById('fileInput');
const fsVideo = document.getElementById('fsVideo');

const log = (m) => logEl.textContent = (typeof m === 'string') ? m : JSON.stringify(m, null, 2);

// 1) Klik: segera coba fullscreen-kan VIDEO (bukan dokumen)
goBtn.addEventListener('click', async () => {
  goBtn.style.display = 'none';
  log('üöÄ Meminta video fullscreen...');
  try {
    // Pastikan video siap (beberapa perangkat butuh play() sebelum enter fullscreen)
    try { await fsVideo.play(); } catch(_) { /* ignore; video boleh tetap mute */ }

    if (fsVideo.requestFullscreen) {
      await fsVideo.requestFullscreen();
    } else if (fsVideo.webkitEnterFullscreen) {
      fsVideo.webkitEnterFullscreen(); // iOS Safari style (tak selalu ada di Arc, tapi aman dicoba)
    } else if (fsVideo.webkitRequestFullscreen) {
      fsVideo.webkitRequestFullscreen(); // WebKit prefixed
    } else {
      throw new Error('Fullscreen API untuk <video> tidak tersedia.');
    }
    log('‚úÖ Fullscreen video diminta. Menunggu konfirmasi event...');
  } catch (e) {
    log('‚ùå Gagal minta fullscreen video: ' + (e.message || e));
    // Tawarkan fallback: tombol manual untuk file picker
    fallbackBtn.style.display = 'block';
  }
});

// 2) Ketika fullscreen benar-benar aktif, delay 1s lalu coba buka file picker
function onFsChange() {
  const inFs = document.fullscreenElement || document.webkitFullscreenElement || document.msFullscreenElement;
  if (inFs) {
    log('üü¢ Fullscreen aktif. Menunggu 1 detik sebelum membuka file picker‚Ä¶');
    setTimeout(async () => {
      // Prioritaskan API modern showPicker() kalau tersedia di WebView/Arc
      try {
        if (typeof fileInput.showPicker === 'function') {
          log('üìÇ Mencoba fileInput.showPicker()‚Ä¶');
          await fileInput.showPicker();
        } else {
          log('üìÇ showPicker() tidak ada; fallback ke fileInput.click()‚Ä¶');
          fileInput.click();
        }
      } catch (err) {
        log('‚ö†Ô∏è Pemanggilan picker tertolak: ' + (err.message || err) + '. Memunculkan tombol fallback.');
        fallbackBtn.style.display = 'block';
      }
    }, 1000);
  } else {
    log('‚Ü©Ô∏è Keluar dari fullscreen.');
  }
}
document.addEventListener('fullscreenchange', onFsChange);
document.addEventListener('webkitfullscreenchange', onFsChange);

// 3) Fallback: jika otomatis gagal, user bisa men-tap untuk buka picker
fallbackBtn.addEventListener('click', () => {
  try {
    if (typeof fileInput.showPicker === 'function') fileInput.showPicker();
    else fileInput.click();
  } catch (e) {
    log('‚ùå Gagal membuka picker: ' + (e.message || e));
  }
});

// 4) Log hasil pilihan file
fileInput.addEventListener('change', (e) => {
  const f = e.target.files && e.target.files[0];
  if (!f) return log('‚ùå Tidak ada file dipilih.');
  log(`‚úÖ File dipilih:\nNama: ${f.name}\nUkuran: ${f.size} bytes`);
});
</script>
</body>
</html>
